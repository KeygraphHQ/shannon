/**
 * start-pentest Prompt
 *
 * A guided prompt template that helps users configure and start a scan.
 */

export const START_PENTEST_PROMPT = {
  name: 'start-pentest',
  description: 'Guide through starting a Shannon penetration test. Validates target, repo, and config before launching.',
  arguments: [
    {
      name: 'url',
      description: 'Target URL to scan (e.g., https://example.com)',
      required: true,
    },
    {
      name: 'repo',
      description: 'Repository folder name under ./repos/',
      required: false,
    },
  ],
};

export function buildStartPentestPrompt(url: string, repo?: string): string {
  const parts = [
    `I want to start a Shannon penetration test against: ${url}`,
    '',
    'Please help me:',
    '1. Verify the target URL is valid',
  ];

  if (repo) {
    parts.push(`2. Confirm the repo "${repo}" exists in repos/`);
  } else {
    parts.push('2. List available repos and help me choose one');
  }

  parts.push(
    '3. Check if there are any relevant configs available',
    '4. Start the scan with the confirmed parameters',
    '5. Show me how to monitor progress',
  );

  return parts.join('\n');
}
